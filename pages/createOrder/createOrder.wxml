<!--  -->
<new-nav-bar navigateBack="true">
  <view slot="center">{{title}}</view>
</new-nav-bar>
<!--  -->

<view class="new-create-order" style='padding-top: {{navBarHeight}}px'>
  <view class="new-order-info">
    <!-- 收货地址 -->
    <view class="new-order-address-wrap" bindtap="gotoAddress">
      <!--  -->
      <view wx:if="{{address}}" class="new-order-address_hasAddress">
        <image class='address-icon' src='../../assets/icons/address_icon.svg' mode='aspectFit'></image>
        <view class="address-info">
          <view class="user">
            <view class="name ellipsis">{{address.name}}</view>
            <view class="mobile">{{address.mobile}}</view>
            <view wx:if="{{address.is_default}}" class="tag">默认</view>
          </view>
          <view class="address">{{address.province}} {{address.city}} {{address.county}} {{address.detail}}</view>
        </view>
        <image class="address-select-icon" src='data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bfill%3A%23060606%3B%7D%3C%2Fstyle%3E%3C%2Fdefs%3E%3Ctitle%3E%E7%94%BB%E6%9D%BF%2011%3C%2Ftitle%3E%3Cg%20id%3D%22%E8%BE%93%E5%87%BA%22%3E%3Cg%20id%3D%22%E6%97%A5%E5%8E%86%22%3E%3Cpath%20class%3D%22cls-1%22%20d%3D%22M5.84%2C19a1%2C1%2C0%2C0%2C1-.72-.31%2C1%2C1%2C0%2C0%2C1%2C0-1.41L12.71%2C10%2C5.15%2C2.72a1%2C1%2C0%2C0%2C1%2C0-1.41%2C1%2C1%2C0%2C0%2C1%2C1.42%2C0l8.31%2C8a1%2C1%2C0%2C0%2C1%2C0%2C1.44l-8.31%2C8A1%2C1%2C0%2C0%2C1%2C5.84%2C19Z%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E'
          mode="aspectFit"></image>
      </view>
      <!--  -->
      <view wx:else class="new-order-address_noAddress">
        <image class='address-icon' src='../../assets/icons/address_icon.svg' mode='aspectFit'></image>
        <view>添加地址</view>
      </view>
      <!--  -->
    </view>
    <!--  -->
    <!-- 商品信息  -->
    <block wx:for="{{variants}}" wx:for-item="variant" wx:key="{{variant}}">
      <view class='new-order-pro-info-wrap'>
        <view wx:if="{{variants.length > 1}}" class="package-title">
          <view class='package-tag'>包裹{{index+1}}</view>
        </view>
        <block wx:for="{{variant.skus}}" wx:for-item="sku" wx:key="{{sku}}">
          <view class="new-order-pro-info">
            <image wx:if="{{sku.sku_image_url || sku.item_image_url}}" src="{{ 'https:' + (sku.sku_image_url || sku.item_image_url) }}" mode='aspectFill'></image>
            <view class="info">
              <view class="name">{{sku.name}}</view>
              <view class="sku">{{sku.attr1}}{{sku.attr2 ? '、'+sku.attr2 : '' }}{{sku.attr3 ? '、'+sku.attr3 : '' }}</view>
              <view class="price">
                <new-price value="{{sku.price}}" font-size="32"></new-price>
                <view class="quantity">×{{sku.quantity}}</view>
              </view>
            </view>
          </view>
          <!--  -->
        </block>
        <!--  -->
        <view class='remark-wrap'>
          <input class="remark" id='{{variant.skus[0].variant_id}}' type='text' placeholder="添加备注..." placeholder-class="placeholder" bindinput='remarkInput'></input>
        </view>
      </view>
    </block>
    <!--  -->
    <!--  -->
  </view>
  <!-- bottom  -->
  <view class="new-order-bottom {{isIpx ? 'fix-iphonex-button' : ''}}">
    <view class='pay-amount'>
      <text>实付款:</text>
      <new-price value="{{amount}}" font-size="32"></new-price>
    </view>
    <view class='pay-postage'>运费{{postage}}元</view>
    <form report-submit="{{true}}" bindsubmit="createOrder">
      <button class="pay-btn" loading='{{createOrderLoading}}' disabled='{{createOrderLoading}}' form-type="submit">
        去付款
      </button>
    </form>
  </view>
</view>